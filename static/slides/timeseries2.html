<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>IM532 3.0 Applied Time Series Forecasting</title>
    <meta charset="utf-8" />
    <meta name="author" content="Dr. Thiyanga Talagala" />
    <meta name="date" content="2020-03-08" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css/duke-blue.css" rel="stylesheet" />
    <link href="libs/remark-css/hygge-duke.css" rel="stylesheet" />
    <link rel="stylesheet" href="libs/cc-fonts.css" type="text/css" />
    <link rel="stylesheet" href="libs/figure-captions.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# IM532 3.0 Applied Time Series Forecasting
## MSc in Industrial Mathematics
### Dr. Thiyanga Talagala
### 8 March 2020

---



## Stochastic processes

"A statistical phenomenon that evolves in time according to probabilistic laws is called a stochastic process." (Box, George EP, et al. Time series analysis: forecasting and control.)

--
 
##  Non-deterministic time series or statistical time series

A sample realization from an infinite population of time series that could have been generated by a stochastic process. 

--

## Probabilistic time series model 

Let `\(\{X_1, X_2, ...\}\)` be a sequence of random variables. Then the joint distribution of the random vector `\([X_1, X_2, ..., X_n]'\)` is 

`$$P[X_1 \le x_1, X_2 \le x_2, ..., X_n \le x_n]$$`
 

where `\(-\infty &lt; x_1, ..., x_n &lt; \infty\)` and `\(n = 1, 2, ...\)`

---


## Mean function

--
The **mean function** of `\(\{X_t\}\)` is

`$$\mu_X(t)=E(X_t).$$`
--
## Covariance function

The **covariance function** of `\(\{X_t\}\)` is

`$$\gamma_X(r, s)=Cov(X_r, X_s)=E[(X_r-\mu_X(r))(X_s-\mu_X(s))]$$`

for all integers `\(r\)` and `\(s\)`.

--

The covariance function of `\(\{X_t\}\)` at lag `\(h\)` is defined by
`$$\gamma_X(h):=\gamma_X(h, 0)=\gamma(t+h, t)=Cov(X_{t+h}, X_t).$$`



---

## Autocovariance function

The autocovariance function of `\({X_t}\)` at lag `\(h\)` is

`$$\gamma_X(h)=Cov(X_{t+h}, X_t).$$`

--

## Autocorrelation function

The autocorrelation function of `\({X_t}\)` at lag `\(h\)` is

`$$\rho_X(h)=\frac{\gamma_X(h)}{\gamma_X(0)}=Cor(X_{t+h}, X_t).$$`

---

## Weekly stationary

A time series `\(\{X_t\}\)` is called weekly stationary if 

- `\(\mu_X(t)\)` is independent of `\(t\)`.

- `\(\gamma_X(t+h, t)\)` is independent of `\(t\)` for each `\(h\)`.

In otherwords the statistical properties of the time series (mean, variance, autocorrelation, etc.) do not depend on the time at which the series is observed, that is no trend or seasonality. However,  a time series with cyclic behaviour (but with no trend or seasonality) is stationary.

--

## Strict stationarity of a time series

A time series `\(\{X_t\}\)` is called weekly stationary if the random vector `\([X_1, X_2..., X_n]'\)` and `\([X_{1+h}, X_{2+h}..., X_{n+h}]'\)` have the same joint distribution for all integers `\(h\)` and `\(n&gt;0\)`.

---

# Simple time series models

## 1. iid noise

1. no trend or seasonal component

2. observations are independent and identically distributed (iid) random variables with zero mean. 

3. Notation: `\(\{X_t\} \sim IID(0, \sigma^2)\)`

4. plays an important role as a building block for more complicated time series.

---------------------------------------------------------------------------------
**Joint distribution function of iid noise**

`$$P[X_1 \le x_1, X_2 \le x_2, ..., X_n \le x_n] = P[X_1 \le x_1]....P[X_n \le x_n].$$`
--
Let `\(F_X(.)\)` be the cumulative distribution function of each of the identically distributed random variables `\(X_1, X_2, ...\)` Then, 
`$$P[X_1 \le x_1, X_2 \le x_2, ..., X_n \le x_n] = F_X(x_1)...F_X(x_n)$$`
--
There is no dependence between observations. Hence,
`$$P[X_{n+h} \le x|X_1=x_1, ..., X_n=x_n] = P[X_{n+h} \le x].$$`

---

## iid noise (cont.)

**Examples of iid noise**

1. Sequence of iid random variables `\(\{X_t, t=1, 2,...\}\)` with `\(P(X_t=1)=\frac{1}{2}\)` and `\(P(X_t = 0)=\frac{1}{2}.\)`

2. 


```r
rnorm(15)
```

```
 [1]  1.9558412243 -0.0459677288 -0.0003297169  2.0568307515  0.2142585968
 [6]  1.6599478863 -0.5202285163 -1.6943792205  0.6154986902 -1.3646823497
[11] -0.1552456284  1.1571832487 -0.1294822963 -0.2496870896  0.9231121906
```

--

## Question

Let `\(\{X_t\}\)` is a iid noise with `\(E(X^2)=\sigma^2&lt;\infty\)`. Show that `\(\{X_t\}\)` is a stationary process.

---
# Simple time series models

## 2. White noise

If `\(\{X_t\}\)` is a sequence of uncorrelated random variables, each with zero mean and variance `\(\sigma^2\)`, then such a sequence is referred to as **white noise**.

Note: Every `\(IID(0, \sigma^2)\)` sequence is `\(WN(0, \sigma^2)\)` but not conversely.

---
# Simple time series models


## 3. Random walk

A random walk process is obtained by cumulatively summing iid random variables. If `\(\{S_t, t=0, 1, 2, ...\}\)` is a random walk process, then
`\(S_0 =0\)`

`\(S_1=0+X_1\)`

`\(S_2=0+X_1+X_2\)`

`\(...\)`

`\(S_t=X_1+X_2+...+X_t.\)`

--

## Question

Is `\(\{S_t, t=0, 1, 2, ...\}\)` a weak stationary process?

---

## Identifying non-stationarity in the mean

- Using time series plot

- ACF plot

   - ACF of stationary time series will drop to relatively quickly.
   
   - The ACF of non-stationary series decreases slowly.
   
   - For non-stationary series, the ACF at lag 1 is often large and positive.


---

# Elimination of Trend and Seasonality by Differencing

- Differencing helps to stabilize the mean.

## Backshift notation: 

`$$BX_t=X_{t-1}$$`

## Ordinary differencing

The first-order differencing can be defined as

`$$\nabla X_t = X_t-X_{t-1}=X_t-BX_t=(1-B)X_t$$`
The second-order differencing

`$$\nabla^2X_t=\nabla(\nabla X_t)=\nabla(X_t-X_{t-1})=\nabla X_t - \nabla X_{t-1}=X_t-2X_{t-1}+X_{t-2}$$`
- In practice, we seldom need to go beyond second order differencing. 


---
## Seasonal differencing

- differencing between an observation and the corresponding observation from the previous year.

`$$\nabla_mX_t=X_t-X_{t-m}=(1-B^m)X_t$$`
where `\(m\)` is the number of seasons. For monthly, `\(m=12\)`, for quarterly `\(m=4\)`.

For monthly series

`$$\nabla_{12}X_t=X_t-X_{t-12}$$`

Twice-differenced series

`$$\nabla^2_{12}X_t=\nabla_{12}X_t-\nabla_{12}X_{t-1}=(X_t-X_{t-12})-(X_{t-1}-X_{t-13})$$`

---

All rights reserved by [Thiyanga S. Talagala](https://thiyanga.netlify.com/)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
